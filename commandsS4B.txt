Rscript R/S4BR.R -c Mutect2 -r 10 -v /mnt/c/Users/sfragkoul/Desktop/synth4bench/results -w /mnt/c/Users/sfragkoul/Desktop/synth4bench/results -m Merged


gt <- gt_analysis(5, "C:/Users/sfragkoul/Desktop/synth4bench/results", "Merged_auto")

out_df <- read_vcf("C:/Users/sfragkoul/Desktop/synth4bench/results", "VarScan", gt, "Merged_auto")

fwrite(
  out_df, paste0("C:/Users/sfragkoul/Desktop/synth4bench/results", "/", "Merged_auto", "_Ground_truth_vs_", "VarScan", ".clean_norm.tsv"),
  row.names = FALSE, quote = FALSE, sep = "\t"
)
##############################################################################

plots <- plot_synth4bench("C:/Users/sfragkoul/Desktop/synth4bench/results", "C:/Users/sfragkoul/Desktop/synth4bench/results", "C:/Users/sfragkoul/Desktop/synth4bench/results", "VarScan", "Merged_auto")

ggsave(
  plot = plots[[1]], filename = paste0("C:/Users/sfragkoul/Desktop/synth4bench/results", "/Plots/Poster_", "VarScan", ".png"),
  width = 16, height = 12, units = "in", dpi = 600
)

ggsave(
  plot = plots[[2]], filename = paste0("C:/Users/sfragkoul/Desktop/synth4bench/results", "/Plots/Venn_", "VarScan", ".png"),
  width = 8, height = 8, units = "in", dpi = 600
)


paste0("C:/Users/sfragkoul/Desktop/synth4bench/results", "/", "Merged_auto", "_mutect2_norm.vcf")

vcf <- read.vcfR(paste0("C:/Users/sfragkoul/Desktop/synth4bench/results", "/", "Merged_auto", "_mutect2_norm.vcf"), verbose = FALSE )
#########################################################################################



Rscript R/S4BR_plot.R -c Freebayes -t /mnt/c/Users/sfragkoul/Desktop/synth4bench/results -g /mnt/c/Users/sfragkoul/Desktop/synth4bench/results -v /mnt/c/Users/sfragkoul/Desktop/synth4bench/results -w /mnt/c/Users/sfragkoul/Desktop/synth4bench/results -m Merged_auto


plots_snvs_FP <- plot_snvs_FP("C:/Users/sfragkoul/Desktop/synth4bench/results", 
                              "Mutect2", 
                              "Merged_auto")
							  
							  
Rscript R/S4BR_plot.R -c Mutect2 -t /mnt/c/Users/sfragkoul/Desktop/synth4bench/results -m Merged



Rscript R/S4BR.R -c Freebayes -r 10 -v  /mnt/d/sfragkoul/Synth_Data/Synthesizers/NEAT/testing/TP53/coverage_test/300_30_10 -w  /mnt/d/sfragkoul/Synth_Data/Synthesizers/NEAT/testing/TP53/coverage_test/300_30_10 -m Merged


Rscript R/S4BR_plot.R -c Freebayes -w /mnt/c/users/sfragkoul/Desktop/synth4bench/results -t /mnt/c/users/sfragkoul/Desktop/synth4bench/results -v /mnt/c/users/sfragkoul/Desktop/synth4bench/results -g /mnt/c/users/sfragkoul/Desktop/synth4bench/results -m Merged



vcflib vcfleftalign -r /mnt/d/sfragkoul/Synth_Data/Synthesizers/NEAT/testing/TP53 /results/Merged_freebayes_norm_test.vcf



printf "bcftools norm /results/Merged_freebayes_norm.vcf"
printf " --output /results/Merged_freebayes_norm_new_new.vcf"
printf " --output-type v"
printf " -m \"-\" "
printf " --check-ref s "
printf "\n"

printf "rm ${working_directory}/${folder}/${output_bam_merged}_freebayes.vcf"
printf "\n \n"



 bcftools norm 
 --output-type v  
 -m - --check-ref s 
 --fasta-ref /mnt/d/sfragkoul/Synth_Data/Synthesizers/NEAT/testing/TP53/TP53.fasta 
 /mnt/c/Users/sfragkoul/Desktop/synth4bench/results/Merged_freebayes_norm.vcf >
 /mnt/c/Users/sfragkoul/Desktop/synth4bench/results/Merged_freebayes_norm_new.vcf
 
 
 #----------------------------------------------------------
 
cd /mnt/c/Users/sfragkoul/Desktop/synth4bench
 
Rscript R/S4BR.R -c Mutect2 -r 10 -w /mnt/c/Users/sfragkoul/Desktop/synth_data/coverage_test/300_30_10 -m Merged
Rscript R/S4BR_plot.R -c Mutect2 -w /mnt/c/Users/sfragkoul/Desktop/synth_data/coverage_test/300_30_10 -m Merged
 
Rscript R/S4BR.R -c Freebayes -r 10 -w /mnt/c/Users/sfragkoul/Desktop/synth_data/coverage_test/300_30_10 -m Merged
Rscript R/S4BR_plot.R -c Freebayes -w /mnt/c/Users/sfragkoul/Desktop/synth_data/coverage_test/300_30_10 -m Merged
 
Rscript R/S4BR.R -c VarDict -r 10 -w /mnt/c/Users/sfragkoul/Desktop/synth_data/coverage_test/300_30_10 -m Merged
Rscript R/S4BR_plot.R -c VarDict -w /mnt/c/Users/sfragkoul/Desktop/synth_data/coverage_test/300_30_10 -m Merged

Rscript R/S4BR.R -c VarScan -r 10 -w /mnt/c/Users/sfragkoul/Desktop/synth_data/coverage_test/300_30_10 -m Merged
Rscript R/S4BR_plot.R -c VarScan -w /mnt/c/Users/sfragkoul/Desktop/synth_data/coverage_test/300_30_10 -m Merged 
#----------------------------------------------------------
#Docker test
 
conda deactivate
docker pull ubuntu:latest
docker pull mgibio/bam-readcount
docker images
docker run --rm -ti mgibio/bam-readcount bash --help
docker run --rm -ti ubuntu bash
docker run --rm -ti ubuntu date
docker ps
docker pull mgibio/bam-readcount:1.0.1
docker run --rm -ti mgibio/bam-readcount:1.0.1 --help

 
 docker run 
--rm 
-v $(pwd):$(pwd) 
-w $(pwd) mgibio/bam-readcount:1.0.1  
-f testing/TP53/TP53.fasta 
testing/TP53/read_length/1000_100/Merged_auto.sorted.bam > testing/TP53/read_length/1000_100/Merged_auto.sorted_report.tsv