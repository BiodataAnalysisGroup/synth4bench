source("libraries.R")
setwd("C:/Users/sfragkoul/Desktop/synth4bench")
# Load the BAM file
bam_file = "Merged.sorted.uniq.rg.bam"
aln <- readGAlignments(bam_file)
# Extract the base qualities
base_qualities <- mcols(aln)$qual
# If a modification function is provided, apply it
if (!is.null(modify_fn) && is.function(modify_fn)) {
new_base_qualities <- lapply(base_qualities, modify_fn)
# Update the base qualities
mcols(aln)$qual <- new_base_qualities
} else {
new_base_qualities <- base_qualities
}
modify_fn= NULL
output_bam = NULL
# If a modification function is provided, apply it
if (!is.null(modify_fn) && is.function(modify_fn)) {
new_base_qualities <- lapply(base_qualities, modify_fn)
# Update the base qualities
mcols(aln)$qual <- new_base_qualities
} else {
new_base_qualities <- base_qualities
}
# Write to a new BAM file if an output path is provided
if (!is.null(output_bam)) {
writeGAlignments(aln, output_bam)
}
# Return the base qualities as a list
return(new_base_qualities)
# Extract the base qualities
base_qualities <- mcols(aln)$qual
BiocManager::install()
